{% extends "fat/base.html" %}

{% block content %}
<h1>Software Sustainability Institute Fellowship Program</h1>
<p>If you need us to process something please use one of the links bellow:</p>
{% if user.is_superuser %}
<div class="row">
  <div class="col-md-4">
  <a class="btn btn-default btn-block" href="{% url 'claimed' %}">Create claim profile</a>
  </div>
  <div class="col-md-4">
    <a class="btn btn-default btn-block" href="{% url 'promote' %}">Upgrade claim profile to fellow claim profile</a>
  </div>
  <div class="col-md-4">
    <a class="btn btn-default btn-block" href="{% url 'report' %}">View summary report of events <strong>(Work in progress)</strong></a>
  </div>
</div>
{% endif %}
<div class="row">
  <div class="col-md-4">
    <a class="btn btn-default btn-block" href="{% url 'fund' %}">Make an funding request</a>
  </div>
  <div class="col-md-4">
    <a class="btn btn-default btn-block" href="{% url 'expense' %}">Submit expense claim</a>
  </div>
  <div class="col-md-4">
    <a class="btn btn-default btn-block" href="{% url 'blog' %}">Submit a blog post</a>
  </div>
</div>
{% if user.is_superuser %}
<p><a href="{% url 'admin:index' %}">Click here</a> to edit the information in the database here (e.g. needed if the dates of an event change).</p>
<p><a href="{% url 'fund_import' %}">Click here</a> to import funding requests
  from a CSV file. <spanp class="text-danger">This is an experimental feature. You will not have access to debug information!</span></p>
{% else %}
<p>If you need any help please email <a href="mailto:{{ settings.FELLOWS_MANAGEMENT_EMAIL }}">us</a>.</p>
{% endif %}
{% if user.is_authenticated %}
{% if user.is_superuser %}
<p>Your pending tasks are:</p>
<h2>
  Funding requests
  <a class="btn btn-default" href="{% url 'fund' %}">Make an funding request</a>
</h2>
<ul class="nav nav-tabs">
  <li role="presentation" {% if request.GET.funding_requests == 'UPARF' %}class="active"{% endif %}>
    <a href="?funding_requests=UPARF">All</a>
  </li>
  <li role="presentation" {% if "funding_requests" not in request.GET or request.GET.funding_requests == 'UP' %}class="active"{% endif %}>
    <a href="?funding_requests=UP">Pending</a>
  </li>
  <li role="presentation" {% if request.GET.funding_requests == 'A' %}class="active"{% endif %}>
    <a href="?funding_requests=A">Approved</a>
  </li>
  <li role="presentation" {% if request.GET.funding_requests == 'R' %}class="active"{% endif %}>
    <a href="?funding_requests=R">Reproved</a>
  </li>
  <li role="presentation" {% if request.GET.funding_requests == 'F' %}class="active"{% endif %}>
    <a href="?funding_requests=F">Archived</a>
  </li>
</ul>
{% if funds %}
<table class="table table-bordered sortable">
  <tbody>
    <tr>
      <th>
        Date
      </th>
      <th>
        Name
      </th>
      <th>
        Status
      </th>
      <th>
        Actions
      </th>
    </tr>
    {% for fund in funds %}
    <tr>
      <td>{{ fund.added }}</td>
      <td>
        <a href="{% url 'fund_review' fund.id %}">{{ fund.name }}</a>
        from <a href="{% url 'claimed_detail' fund.claimed.id %}">{{ fund.claimed.fullname }}</a>
      </td>
      <td>
        {{ fund.get_status_display }}
        {% if fund.status == 'F' %}
        - contact <a href="claimeds-management@software.ac.uk">claimeds-management@software.ac.uk</a>
        if need
        {% endif %}
      </td>
      <td>
        <a href="{% url 'fund_review' fund.id %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
<h2>
  Expenses
 <a class="btn btn-default" href="{% url 'expense' %}">Submit expense claim</a>
</h2>
<ul class="nav nav-tabs">
  <li role="presentation" {% if request.GET.expenses == 'WSCPAF' %}class="active"{% endif %}>
    <a href="?expenses=WSCPAF">All</a>
  </li>
  <li role="presentation" {% if "expenses" not in request.GET or request.GET.expenses == 'WSC' %}class="active"{% endif %}><a href="?expenses=WSC">Pending</a></li>
  <li role="presentation" {% if request.GET.expenses == 'PAF' %}class="active"{% endif %}><a href="?expenses=PAF">Approved</a></li>
</ul>
{% if expenses %}
<table class="table table-bordered sortable">
  <tbody>
    <tr>
      <th>
        Date
      </th>
      <th>
        Name
      </th>
      <th>
        Status
      </th>
      <th>
        Actions
      </th>
    </tr>
    {% for expense in expenses %}
    <tr>
      <td>{{ expense.added }}</td>
      <td>
        <a href="{% url 'expense_review_relative' expense.fund.id expense.relative_number %}">#{{ expense.relative_number }}</a>
        from <a href="{% url 'claimed_detail' expense.fund.claimed.id %}">{{ expense.fund.claimed.fullname }}</a>
        for <a href="{% url 'fund_detail' expense.fund.id %}">{{ expense.fund.name }}</a>
      </td>
      <td>
        {{ expense.get_status_display }}
      </td>
      <td>
        <a href="{% url 'expense_review' expense.id %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
<h2>
  Blog Posts
  <a class="btn btn-default" href="{% url 'blog' %}">Submit a blog post</a>
</h2>
<ul class="nav nav-tabs">
  <li role="presentation" {% if request.GET.blogs == 'URLPDO' %}class="active"{% endif %}>
    <a href="?blogs=URLPDO">All</a>
  </li>
  <li role="presentation" {% if "blogs" not in request.GET or request.GET.blogs == 'UR' %}class="active"{% endif %}>
    <a href="?blogs=UR">Pending</a>
  </li>
  <li role="presentation" {% if request.GET.blogs == 'P' %}class="active"{% endif %}>
    <a href="?blogs=P">Published</a>
  </li>
</ul>
{% if blogs %}
<table class="table table-bordered sortable">
  <tbody>
    <tr>
      <th>
        Date
      </th>
      <th>
        Name
      </th>
      <th>
        Status
      </th>
      <th>
        Actions
      </th>
    </tr>
    {% for blog in blogs %}
    <tr>
      <td>{{ blog.added }}</td>
      <td>
        <a href="{% url 'blog_review' blog.id %}">{{ blog.draft_url }}</a> from
        <a href="{% url 'fund_detail' blog.fund.id %}">{{ blog.fund.name }}</a>
      </td>
      <td>
        {{ blog.get_status_display }}
      </td>
      <td>
        <a href="{% url 'blog_review' blog.id %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% else %}
{% include 'fat/finances.html' %}
<h2>
  Funding Requests
  <a class="btn btn-default" href="{% url 'fund' %}">New funding request</a>
</h2>
<table class="table table-bordered sortable">
  <tbody>
    <tr>
      <th>
        Fund
      </th>
      <th>
        Status
      </th>
    </tr>
    {% for fund in funds %}
    <tr
       {% if fund.status in 'U' %}
       class="danger"
       {% elif fund.status in 'P' %}
       class="warning"
       {% elif fund.status in 'AR' %}
       class="sucess"
       {% endif %}
       >
      <td>
        <a href="{% url 'fund_detail' fund.id %}">{{ fund.name }}</a>
      </td>
      <td>
        {{ fund.get_status_display }}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% endif %}
{% endblock %}
